<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Synergy - Full Screen Pomodoro Timer</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap">
    <link rel="shortcut icon" href="https://cdn-icons-png.flaticon.com/128/14118/14118018.png" type="image/png">
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="background-blobs">
        <div class="blob blob-1"></div>
        <div class="blob blob-2"></div>
        <div class="blob blob-3"></div>
    </div>
    
    <div class="container">
        <header>
            <h1><i class="fas fa-infinity"></i> Synergy</h1>
            <p class="tagline">Your personal hub for focus and productivity.</p>
        </header>

        <div class="app-container">
            <div class="todo-container">
                <h2><i class="fa-solid fa-list-check"></i> My Tasks</h2>
                <div class="todo-form">
                    <input type="text" id="task-input" placeholder="Add a new task...">
                    <button id="add-task-btn" class="btn btn-primary">
                        <i class="fas fa-plus"></i> Add
                    </button>
                </div>
                <ul id="task-list">
                    <!-- Tasks will be rendered here -->
                </ul>
                
                <!-- Bin Section -->
                <div class="bin-container">
                    <div class="bin-header">
                        <h3><i class="fas fa-trash"></i> Bin</h3>
                        <span class="bin-toggle"><i class="fas fa-chevron-down"></i></span>
                    </div>
                    <div class="bin-content">
                        <ul id="bin-list">
                            <!-- Deleted tasks will be rendered here -->
                        </ul>
                        <div class="bin-actions" style="margin-top: 1rem; text-align: center;">
                            <button id="empty-bin-btn" class="btn btn-danger">
                                <i class="fas fa-trash"></i> Empty Bin
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <div class="timer-container">
                <div class="timer-content">
                    <h2><i class="fa-solid fa-hourglass-half"></i> Timer</h2>
                    <div class="task-display-container">
                        <p id="current-task-display">Select a task to begin</p>
                    </div>
                    <div id="timer-display">25:00</div>
                    <div class="timer-controls">
                        <button id="start-btn" class="btn btn-success"><i class="fas fa-play"></i></button>
                        <button id="pause-btn" class="btn btn-warning"><i class="fas fa-pause"></i></button>
                        <button id="reset-btn" class="btn btn-danger"><i class="fas fa-redo"></i></button>
                    </div>
                    <div class="timer-modes">
                        <button class="mode-btn active" data-time="1500">Pomodoro</button>
                        <button class="mode-btn" data-time="300">Short Break</button>
                        <button class="mode-btn" data-time="900">Long Break</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // DOM Element References
        const taskInput = document.getElementById('task-input');
        const addTaskBtn = document.getElementById('add-task-btn');
        const taskList = document.getElementById('task-list');
        const binList = document.getElementById('bin-list');
        const binToggle = document.querySelector('.bin-toggle');
        const binContent = document.querySelector('.bin-content');
        const emptyBinBtn = document.getElementById('empty-bin-btn');
        const currentTaskDisplay = document.getElementById('current-task-display');
        const timerDisplay = document.getElementById('timer-display');
        const startBtn = document.getElementById('start-btn');
        const pauseBtn = document.getElementById('pause-btn');
        const resetBtn = document.getElementById('reset-btn');
        const modeButtons = document.querySelectorAll('.mode-btn');

        // App State
        let tasks = [];
        let deletedTasks = [];
        let selectedTaskId = null;
        let timerInterval = null;
        let timeLeft = 25 * 60; // 25 minutes in seconds
        let isPaused = true;
        const notificationSound = new Audio('https://www.soundjay.com/buttons/sounds/button-16.mp3');

        // Initialize the app
        function init() {
            loadTasks();
            loadDeletedTasks();
            renderTasks();
            renderBinTasks();
            updateTimerDisplay();
            updateButtonStates();
            setupEventListeners();
        }

        // Load tasks from localStorage
        function loadTasks() {
            const savedTasks = localStorage.getItem('synergy-tasks');
            if (savedTasks) {
                tasks = JSON.parse(savedTasks);
            }
        }

        // Load deleted tasks from localStorage
        function loadDeletedTasks() {
            const savedDeletedTasks = localStorage.getItem('synergy-deleted-tasks');
            if (savedDeletedTasks) {
                deletedTasks = JSON.parse(savedDeletedTasks);
            }
        }

        // Save tasks to localStorage
        function saveTasks() {
            localStorage.setItem('synergy-tasks', JSON.stringify(tasks));
        }

        // Save deleted tasks to localStorage
        function saveDeletedTasks() {
            localStorage.setItem('synergy-deleted-tasks', JSON.stringify(deletedTasks));
        }

        // === Task Management Functions ===
        function renderTasks() {
            taskList.innerHTML = '';
            
            if (tasks.length === 0) {
                const emptyState = document.createElement('li');
                emptyState.className = 'empty-state';
                emptyState.innerHTML = `
                    <i class="fas fa-clipboard-list"></i>
                    <p>No tasks yet. Add one to get started!</p>
                `;
                taskList.appendChild(emptyState);
                return;
            }

            tasks.forEach(task => {
                const li = document.createElement('li');
                li.setAttribute('data-id', task.id);
                li.className = task.completed ? 'completed' : '';
                if (task.id === selectedTaskId) {
                    li.classList.add('selected');
                }

                li.innerHTML = `
                    <span class="task-text">${task.text}</span>
                    <span class="pomodoro-count">${task.pomodoros} <i class="fas fa-clock"></i></span>
                    <div class="task-actions">
                        <button class="complete-btn" title="Complete">
                            <i class="fas fa-check"></i>
                        </button>
                        <button class="delete-btn" title="Delete">
                            <i class="fas fa-trash"></i>
                        </button>
                    </div>
                `;

                li.querySelector('.complete-btn').addEventListener('click', (e) => {
                    e.stopPropagation();
                    toggleTaskComplete(task.id);
                });

                li.querySelector('.delete-btn').addEventListener('click', (e) => {
                    e.stopPropagation();
                    moveTaskToBin(task.id);
                });

                li.addEventListener('click', () => {
                    selectTask(task.id);
                });
                
                taskList.appendChild(li);
            });
        }

        function renderBinTasks() {
            binList.innerHTML = '';
            
            if (deletedTasks.length === 0) {
                const emptyState = document.createElement('li');
                emptyState.className = 'empty-state';
                emptyState.innerHTML = `
                    <i class="fas fa-trash"></i>
                    <p>Bin is empty</p>
                `;
                binList.appendChild(emptyState);
                return;
            }

            deletedTasks.forEach(task => {
                const li = document.createElement('li');
                li.setAttribute('data-id', task.id);

                li.innerHTML = `
                    <span class="task-text">${task.text}</span>
                    <span class="pomodoro-count">${task.pomodoros} <i class="fas fa-clock"></i></span>
                    <div class="task-actions">
                        <button class="restore-btn" title="Restore">
                            <i class="fas fa-undo"></i>
                        </button>
                        <button class="permanent-delete-btn" title="Permanently Delete">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                `;

                li.querySelector('.restore-btn').addEventListener('click', (e) => {
                    e.stopPropagation();
                    restoreTask(task.id);
                });

                li.querySelector('.permanent-delete-btn').addEventListener('click', (e) => {
                    e.stopPropagation();
                    permanentDeleteTask(task.id);
                });
                
                binList.appendChild(li);
            });
        }

        function addTask() {
            const text = taskInput.value.trim();
            if (text) {
                const newTask = {
                    id: Date.now(),
                    text: text,
                    completed: false,
                    pomodoros: 0
                };
                tasks.push(newTask);
                taskInput.value = '';
                saveTasks();
                renderTasks();
                // Auto-select the new task if none is selected
                if (!selectedTaskId) {
                    selectTask(newTask.id);
                }
            }
        }

        function toggleTaskComplete(id) {
            tasks = tasks.map(task => 
                task.id === id ? { ...task, completed: !task.completed } : task
            );
            saveTasks();
            renderTasks();
        }

        function moveTaskToBin(id) {
            const taskIndex = tasks.findIndex(task => task.id === id);
            if (taskIndex !== -1) {
                const taskToDelete = tasks[taskIndex];
                deletedTasks.push(taskToDelete);
                tasks.splice(taskIndex, 1);
                
                saveTasks();
                saveDeletedTasks();
                
                if (selectedTaskId === id) {
                    selectedTaskId = null;
                    currentTaskDisplay.textContent = 'Select a task to begin';
                    resetTimer();
                }
                
                renderTasks();
                renderBinTasks();
                
                // Show notification
                showNotification('Task moved to bin');
            }
        }

        function restoreTask(id) {
            const taskIndex = deletedTasks.findIndex(task => task.id === id);
            if (taskIndex !== -1) {
                const taskToRestore = deletedTasks[taskIndex];
                tasks.push(taskToRestore);
                deletedTasks.splice(taskIndex, 1);
                
                saveTasks();
                saveDeletedTasks();
                
                renderTasks();
                renderBinTasks();
                
                // Show notification
                showNotification('Task restored');
            }
        }

        function permanentDeleteTask(id) {
            const taskIndex = deletedTasks.findIndex(task => task.id === id);
            if (taskIndex !== -1) {
                deletedTasks.splice(taskIndex, 1);
                saveDeletedTasks();
                renderBinTasks();
                
                // Show notification
                showNotification('Task permanently deleted');
            }
        }

        function emptyBin() {
            if (deletedTasks.length > 0) {
                if (confirm('Are you sure you want to permanently delete all tasks in the bin?')) {
                    deletedTasks = [];
                    saveDeletedTasks();
                    renderBinTasks();
                    
                    // Show notification
                    showNotification('Bin emptied');
                }
            }
        }

        function selectTask(id) {
            selectedTaskId = id;
            const selectedTask = tasks.find(task => task.id === selectedTaskId);
            currentTaskDisplay.textContent = `Focusing on: ${selectedTask.text}`;
            renderTasks();
        }

        function updateButtonStates() {
            // Disable start button when timer is running
            startBtn.disabled = !isPaused;
            
            // Disable pause button when timer is not running
            pauseBtn.disabled = isPaused;
            
            // Add/remove active class based on state
            if (!isPaused) {
                startBtn.classList.remove('active');
                pauseBtn.classList.add('active');
            } else {
                startBtn.classList.add('active');
                pauseBtn.classList.remove('active');
            }
        }

        // Modify the timer functions to call updateButtonStates
        function startTimer() {
            if (!selectedTaskId) {
                alert('Please select a task to focus on first!');
                return;
            }
            if (isPaused) {
                isPaused = false;
                updateButtonStates();
                timerInterval = setInterval(() => {
                    timeLeft--;
                    updateTimerDisplay();
                    if (timeLeft <= 0) {
                        clearInterval(timerInterval);
                        notificationSound.play();
                        showCompletionNotification();
                        incrementPomodoro();
                        resetTimer();
                        updateButtonStates();
                    }
                }, 1000);
            }
        }

        function pauseTimer() {
            isPaused = true;
            clearInterval(timerInterval);
            updateButtonStates();
        }

        function resetTimer() {
            pauseTimer();
            timeLeft = 25 * 60;
            updateTimerDisplay();
            updateButtonStates();
        }

        // === Timer Functions ===
        function updateTimerDisplay() {
            const minutes = Math.floor(timeLeft / 60);
            const seconds = timeLeft % 60;
            timerDisplay.textContent = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
            
            // Visual feedback when time is running low
            if (timeLeft <= 60) {
                timerDisplay.style.color = 'var(--accent)';
            } else {
                timerDisplay.style.color = 'var(--primary-dark)';
            }
        }

        function incrementPomodoro() {
            if (selectedTaskId) {
                tasks = tasks.map(task =>
                    task.id === selectedTaskId ? { ...task, pomodoros: task.pomodoros + 1 } : task
                );
                saveTasks();
                renderTasks();
            }
        }

        function showCompletionNotification() {
            const notification = document.createElement('div');
            notification.className = 'notification';
            notification.innerHTML = `
                <i class="fas fa-check-circle"></i>
                <p>Pomodoro complete! Time for a break.</p>
            `;
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.classList.add('show');
            }, 10);
            
            setTimeout(() => {
                notification.classList.remove('show');
                setTimeout(() => {
                    notification.remove();
                }, 300);
            }, 3000);
        }

        function showNotification(message) {
            const notification = document.createElement('div');
            notification.className = 'notification';
            notification.innerHTML = `
                <i class="fas fa-info-circle"></i>
                <p>${message}</p>
            `;
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.classList.add('show');
            }, 10);
            
            setTimeout(() => {
                notification.classList.remove('show');
                setTimeout(() => {
                    notification.remove();
                }, 300);
            }, 2000);
        }

        function setTimerMode(minutes) {
            timeLeft = minutes;
            resetTimer();
            updateTimerDisplay();
        }

        // === Event Listeners ===
        function setupEventListeners() {
            addTaskBtn.addEventListener('click', addTask);
            taskInput.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') {
                    addTask();
                }
            });

            startBtn.addEventListener('click', startTimer);
            pauseBtn.addEventListener('click', pauseTimer);
            resetBtn.addEventListener('click', resetTimer);

            modeButtons.forEach(button => {
                button.addEventListener('click', () => {
                    modeButtons.forEach(btn => btn.classList.remove('active'));
                    button.classList.add('active');
                    setTimerMode(parseInt(button.dataset.time));
                });
            });

            // Bin toggle
            binToggle.addEventListener('click', () => {
                binContent.classList.toggle('show');
                binToggle.classList.toggle('open');
            });

            // Empty bin button
            emptyBinBtn.addEventListener('click', emptyBin);
        }

        // Initialize the app
        init();
    </script>
</body>
</html>